<!DOCTYPE html>
<html lang="en-us">

<head>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-108705746-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-108705746-1');
</script>


<style type="text/css">
img[src$='#floatcenter']
{
display: block;
margin: 0.7rem auto;
}
</style>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<meta charset="utf-8">
<meta charset="EUC-KR">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="Taeoh Kim&#39;s Personal Blog">
<base href="https://taeoh-kim.github.io/">
<title>


     Bayes Theorem과 Sigmoid와 Softmax사이의 관계 

</title>
<link rel="canonical" href="https://taeoh-kim.github.io/blog/bayes-theorem%EA%B3%BC-sigmoid%EC%99%80-softmax%EC%82%AC%EC%9D%B4%EC%9D%98-%EA%B4%80%EA%B3%84/">







<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>



<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>


<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500|Work+Sans">



    
    <link rel="stylesheet" href="https://taeoh-kim.github.io/css/light-style.css?t=1558077679">
    




<link rel="shortcut icon"

    href="https://taeoh-kim.github.io/img/fav.ico"

>








</head>

<body lang="en">
  


<div class="section" id="top">

    <div class="container hero  fade-in one ">
    <h2 class="bold-title is-1">Taeoh Kim's Blog</h2>
    </div>


<div class="section  fade-in two ">

    <div class="container">
    <hr>
<nav class="nav nav-center">
    <span id="nav-toggle" class="nav-toggle"  onclick="document.getElementById('nav-menu').classList.toggle('is-active');">
      <span></span>
      <span></span>
      <span></span>
    </span>
    <div id="nav-menu" class="nav-left nav-menu">
      <span class="nav-item">
        <a href="https://taeoh-kim.github.io/">Main</a>
      </span>
      <span class="nav-item">
        <a href="https://taeoh-kim.github.io/#about">About</a> 
      </span>
    
    
      <span class="nav-item">
        <a href="https://taeoh-kim.github.io/#blog">Back to blog</a> 
      </span>
    
      <span class="nav-item">
        <a href="https://taeoh-kim.github.io/#contact">Contact</a>
      </span>
    
      <span class="nav-item">
        <a href="https://taeoh-kim.github.io/index.xml"><i class="fa fa-rss"></i></a>
      </span>
    
    </div>
</nav>
<hr>
    </div>

    <div class="container  fade-in two ">
        <h2 class="title is-1 top-pad strong-post-title"><a href="https://taeoh-kim.github.io/blog/bayes-theorem%EA%B3%BC-sigmoid%EC%99%80-softmax%EC%82%AC%EC%9D%B4%EC%9D%98-%EA%B4%80%EA%B3%84/">Bayes Theorem과 Sigmoid와 Softmax사이의 관계</a></h2>
            <div class="post-data">
                Sep 22, 2017 |
                4 minutes read
            </div>

            
                <div class="blog-share">
                Share this:
                <a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Read%20Bayes%20Theorem%ea%b3%bc%20Sigmoid%ec%99%80%20Softmax%ec%82%ac%ec%9d%b4%ec%9d%98%20%ea%b4%80%ea%b3%84%20https%3a%2f%2ftaeoh-kim.github.io%2fblog%2fbayes-theorem%25EA%25B3%25BC-sigmoid%25EC%2599%2580-softmax%25EC%2582%25AC%25EC%259D%25B4%25EC%259D%2598-%25EA%25B4%2580%25EA%25B3%2584%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fa fa-twitter"></i>
                <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftaeoh-kim.github.io%2fblog%2fbayes-theorem%25EA%25B3%25BC-sigmoid%25EC%2599%2580-softmax%25EC%2582%25AC%25EC%259D%25B4%25EC%259D%2598-%25EA%25B4%2580%25EA%25B3%2584%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fa fa-facebook"></i>
                <span class="hidden">Facebook</span>
                </a>
                <a class="icon-pinterest" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftaeoh-kim.github.io%2fblog%2fbayes-theorem%25EA%25B3%25BC-sigmoid%25EC%2599%2580-softmax%25EC%2582%25AC%25EC%259D%25B4%25EC%259D%2598-%25EA%25B4%2580%25EA%25B3%2584%2f&amp;description=Bayes%20Theorem%ea%b3%bc%20Sigmoid%ec%99%80%20Softmax%ec%82%ac%ec%9d%b4%ec%9d%98%20%ea%b4%80%ea%b3%84"
                onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
                <i class="fa fa-pinterest"></i>
                <span class="hidden">Pinterest</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https%3a%2f%2ftaeoh-kim.github.io%2fblog%2fbayes-theorem%25EA%25B3%25BC-sigmoid%25EC%2599%2580-softmax%25EC%2582%25AC%25EC%259D%25B4%25EC%259D%2598-%25EA%25B4%2580%25EA%25B3%2584%2f"
                onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                <i class="fa fa-linkedin"></i>
                <span class="hidden">Google+</span>
                </a>
                </div>
            

    </div>

    <div class="container markdown  fade-in two  top-pad">
        

<h2 id="computer-vision-and-machine-learning-study-post-5">Computer Vision and Machine Learning Study Post 5</h2>

<h3 id="bayes-theorem과-sigmoid와-softmax사이의-관계">Bayes Theorem과 Sigmoid와 Softmax사이의 관계</h3>

<p><br><br>
Reference는 다음과 같습니다.</p>

<ul>
<li>Pattern Recognition and Machine Learning, Bishop, 2006</li>
</ul>

<p><br><br></p>

<h3 id="1-bayes-theorem">1. Bayes Theorem</h3>

<p><br></p>

<p>$$ P(Y|X) = \frac{P(X|Y)P(Y)}{P(X)} $$</p>

<p>위 식에서 좌변은 사후 확률 Posterior라고 부르고, P(X|Y)는 Likelihood 또는 Class-conditional Data Distribution, P(Y)는 Prior 그리고 P(X)는 Evidence라고 부른다.</p>

<p>여기서 X를 Data, Y를 Classifiaction 문제의 Class로 본다면, Prior라는 것은 그 Class들의 분포가 어떻게 되어있는지에 대한 사전 지식을 의미하고, P(X|Y)는 각 Class에 속해 있는 Data의 확률 분포, 그리고 사후 확률 P(Y|X)는 새로운 데이타가 들어 왔을 경우 Y의 분포로, 이것으로 어떤 Class Y에 속할 지를 정할 수 있다.</p>

<p>확률의 Marginal 특징에 의하여 분모인 Evidence는 다음과 같이 쓸 수 있다.</p>

<p>$$ P(X) = \sum _{j}^{}{P(X|Y_j) P(Y_j)} $$</p>

<p>이제 이것이 Classification 문제에서 어떻게 적용되는지를 살펴보도록 하자.</p>

<p><br><br></p>

<h3 id="2-logistic-function-2-class-classification">2. Logistic Function: 2-Class Classification</h3>

<p><br></p>

<p>우리가 분류를 하고자 할 때, 즉 새로운 데이터를 분류하고자 할 때 사후확률을 기준으로 삼는다, 즉,</p>

<p>$$ X:Y_1 \text{  if  } P(Y_1 | X) &gt; P(Y_2 | X) $$
$$ X:Y_2 \text{  if  } P(Y_1 | X) &lt; P(Y_2 | X) $$</p>

<p>위와 같이 1과 2 두개의 Class가 있을 경우에 판별 기준인 Posterior를 전개해 보도록 하자,</p>

<p>$$ P(Y_1 | X) = \frac{P(X | Y_1) P(Y_1)}{P(X)} $$
$$ P(Y_2 | X) = \frac{P(X | Y_2) P(Y_2)}{P(X)} $$</p>

<p>그런데 여기서, 분모는</p>

<p>$$ P(X) = P(X | Y_1)P(Y_1) + P(X | Y_2)P(Y_2) $$</p>

<p>이므로 두 식에서 모두 같다.</p>

<p>즉 사후 확률은 Likelihood와 Prior의 곱이 결정한다는 것이다. 즉 각 Class별로 Likelihood와 Prior의 곱을 정의하는 것은 의미가 있다라는 것이 중요하다.</p>

<p>여기서 우리는,</p>

<p>$$ a_k = ln(P(X|Y_k)P(Y_k)) $$</p>

<p>라는 것으로 Likelihood와 Prior의 곱을 정의하도록 하자.</p>

<p>왜 Log(ln)을 붙이는 지는 Log Likelihood를 본다면 알 수 있듯이 다음과 같다.</p>

<ul>
<li>Log는 단조 증가 함수로서 극점을 변화시키지 않는다.</li>
<li>각 시행이 독립일 경우 곱이 덧셈으로 바뀌어 계산이 용이해진다.</li>
<li>확률분포가 Gaussian 등의 Exponential Family일 경우 계산이 용이해진다.</li>
</ul>

<p>그러면 Class 1의 사후 확률은 다음과 같이 된다.</p>

<p>$$ P(Y_1 | X) = \frac{P(X | Y_1) P(Y_1)}{P(X | Y_1)P(Y_1) + P(X | Y_2)P(Y_2)} = \frac{e^{a_1}}{e^{a_1}+e^{a_2}} $$</p>

<p>분모와 분자를 모두 분자로 나누면,</p>

<p>$$ P(Y_1 | X) = \frac{1}{1+e^{a_2 - a_1}} $$</p>

<p>여기서,</p>

<p>$$ a_2 - a_1 = ln( \frac{P(X | Y_2)P(Y_2)}{P(X | Y_1)P(Y_1)} ) $$</p>

<p>이고, 분모 분자를 뒤집어 새로 하나를 정의하자면 (이것을 Log Odds라고 부른다)</p>

<p>$$ a = -(a_2 - a_1) = ln(\frac{P(X | Y_1)P(Y_1)}{P(X | Y_2)P(Y_2)}) $$</p>

<p>그러면 다시 사후 확률로 돌아가면 다음과 같다.</p>

<p>$$ P(Y_1 | X) = \frac{1}{1+e^{-a}} $$</p>

<p>a에 대한 함수로서 이것을 그려 보면, Deep Learning 해본 사람은 누구나 다 아는 Sigmoid Function (정식 명칭: Logistic Function)이 된다.</p>

<p>Naive Bayes를 예로 분류 문제를 풀어 본다면, 보통은 Likelihood는 Gaussian으로 정의한다.</p>

<p>즉 한 Class 내에서의 확률 분포는 평균과 분산을 가지는 Gaussian정도가 적합하다는 것이다.</p>

<p>그리고 Prior의 경우에는 두 가지 중 선택의 문제이므로 Bernoulli 분포로 두면 적당하다.</p>

<p>Log Odds에 해당하는 부분에 이러한 분포들이 들어가게 되면 Naive Bayes 분류기가 되며 이것은 대표적인 Generative Model이다.</p>

<p>만약 우리가, Likelihood와 Prior의 확률 분포를 구분하지 않고 바로 다음 함수,</p>

<p>$$ P(Y|X) = \frac{1}{1+e^{-\theta x}} $$</p>

<p>에 Fitting하는 문제로 바꾼다면 이것은 대표적인 Discriminative 문제인 Logistic Regression이 된다.</p>

<p><br><br></p>

<h3 id="3-softmax-function-k-class-classification">3. Softmax Function: K-Class Classification</h3>

<p><br></p>

<p>2-Class (Binary Class)가 아니고 K-Class 문제의 경우에는 어떻게 될까?</p>

<p>우리는 사후 확률 분포로 판단을 하고, 그것은 Likelihood와 Prior의 곱에 비례했기에 다음을 정의하였다.</p>

<p>$$ a_k = ln(P(X|Y_k)P(Y_k)) $$</p>

<p>그래서 2-Class Classificaiton에서는 Class 1에 대한 사후 확률은 다음과 같이 되었었다.</p>

<p>$$ P(Y_1 | X) = \frac{e^{a_1}}{e^{a_1}+e^{a_2}} $$</p>

<p>K-Class의 경우 Class 1에 대한 사후 확률을 우선은 Bayes로 전개해 보면,</p>

<p>$$ P(Y_1 | X) = \frac{P(X|Y_1)P(Y_1)}{P(X|Y_1)P(Y_1) + P(X|Y_2)P(Y_2) + &hellip; + P(X|Y_k)P(Y_k)} $$</p>

<p>여기에 위에서 정의한 것을 대입하면,</p>

<p>$$ P(Y_1 | X) = \frac{e^{a_1}}{e^{a_1}+e^{a_2}+&hellip;+e^{a_k}} = \frac{e^{a_1}}{\sum _{j}^{}{e^{a_j}}} $$</p>

<p>결국 이것이 Deep Learning에서 많이 보던 Softmax Function이 된다.</p>

<p>저 Normalization Term (분모) 때문에 한 Class의 확률이 다른 Class에 영향을 미치게 되며,</p>

<p>Generative Model (Naive Bayes나 Gaussian Discriminant Analysis 등)에서는 Prior P(Y)에도 영향을 주게 된다.</p>

<p>이것을 다음 함수,</p>

<p>$$ P(Y|X) = \frac{e^{\theta_1 x}}{\sum _{j}^{}{e^{\theta_j x_j}}} $$</p>

<p>Prior고려없이 바로 P(Y|X)를 Fitting하면 Discriminant Model인 이것은 Softmax Regression 된다.</p>

<p><br><br></p>

<h3 id="마치며">마치며..</h3>

<p><br></p>

<p>이번 포스트와 저번 포스트부터는 이론적인 측면을 좀 다루었는데, 사실 용어정리가 굉장히 중요한 것으로 느껴졌다. Maximum Likelihood부터, Random Variable, Posterior, Prior, Generative Model과 Discriminative Model, Parametric Method와 Non-Parametric Method, Non-Bayesian과 Bayesian Approach 등 결국 앞으로도 계속 하고자 하는 것은 기초 개념 정리를 단단히 하려는 것이다. 최종적으로는 매우 어려운 것을 접했을 때 그것을 쉽게 풀어내기 위함이다.</p>

<p>머신러닝/딥러닝 등의 분야에서는 선형 대수, 확률 그리고 최적화 정도가 중요한 Background가 되는데 선형 대수까지 하기에는 역량이 부족하고 그나마 확률과 최적화에 대해서는 앞으로도 계속 다뤄보고 싶다. 실제 구현과 여러가지 분야에 대한 잡설과 함께 할 예정이다.</p>

    </div>

    <div class="disqus">
        
    </div>

<div class="container has-text-centered top-pad">
<hr>
<a href="https://taeoh-kim.github.io/blog/bayes-theorem%EA%B3%BC-sigmoid%EC%99%80-softmax%EC%82%AC%EC%9D%B4%EC%9D%98-%EA%B4%80%EA%B3%84/#top"><i class="fa fa-arrow-up"></i></a>
<hr>
</div>

<div class="section" id="footer">
    <div class="container has-text-centered">
        
        <span class="footer-text"><a href="https://github.com/vickylaiio/hugo-theme-introduction" target="_blank">Introduction</a> theme for <a href="http://gohugo.io/" target="_blank">Hugo</a>. Made by Taeoh Kim. <a href="https://vickylai.io" target="_blank">Vicky Lai</a> 2017</span>
        
    </div>
</div>

</div>
</div>


<script>
$('a[href^="https:\/\/taeoh-kim.github.io\/blog\/bayes-theorem%EA%B3%BC-sigmoid%EC%99%80-softmax%EC%82%AC%EC%9D%B4%EC%9D%98-%EA%B4%80%EA%B3%84\/#"]').click(function(e) {
    e.preventDefault();
    var target = this.hash;
    $('html, body').animate({
    scrollTop: $(target).offset().top
    }, 500);
    return false;
})
</script>

</body>
